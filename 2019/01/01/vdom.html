<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  <title>译文：Understanding the Virtual DOM | Solitude is freedom</title>
  <!-- <meta name="description" content="A man who dreams of being a full stack engineer" />
  <meta name="keywords" content="Javascript,Nodejs,Vue,Nuxt,Other" /> -->
  <meta name="HandheldFriendly" content="True">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- <link rel="shortcut icon" href="/"> -->
  <link rel="icon" href="/images/favicon.ico">
  <link rel="alternate" href="/atom.xml" title="Solitude is freedom">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="本文为译文，原文地址：  Understanding the Virtual DOM  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;我最近在写一些如何正确区分 dom 与 shadow dom 的文章。总的来说，dom 是HTML文档的基于对象的表示，以及操作该对象的接口。shadow dom 可以被认为是轻量级版本的 dom。它同样是以原生对象">
<meta name="keywords" content="虚拟Dom">
<meta property="og:type" content="article">
<meta property="og:title" content="译文：Understanding the Virtual DOM">
<meta property="og:url" content="https://i7eo.com/2019/01/01/vdom.html">
<meta property="og:site_name" content="Solitude is freedom">
<meta property="og:description" content="本文为译文，原文地址：  Understanding the Virtual DOM  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;我最近在写一些如何正确区分 dom 与 shadow dom 的文章。总的来说，dom 是HTML文档的基于对象的表示，以及操作该对象的接口。shadow dom 可以被认为是轻量级版本的 dom。它同样是以原生对象">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://i7eo.com/2019/01/01/vdom/i7eo_854852a0e956219a4a2a016470fe6c6c.png">
<meta property="og:image" content="https://i7eo.com/2019/01/01/vdom/i7eo_854852a0e956219a4a2a016470fe6c6c.png">
<meta property="og:image" content="https://i7eo.com/2019/01/01/vdom/i7eo_e5b8b50c2235d093133d181540a27ca4.png">
<meta property="og:image" content="https://i7eo.com/2019/01/01/vdom/i7eo_f5991aaaa93507781a69bbf70d507739.png">
<meta property="og:updated_time" content="2019-01-06T04:22:24.421Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="译文：Understanding the Virtual DOM">
<meta name="twitter:description" content="本文为译文，原文地址：  Understanding the Virtual DOM  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;我最近在写一些如何正确区分 dom 与 shadow dom 的文章。总的来说，dom 是HTML文档的基于对象的表示，以及操作该对象的接口。shadow dom 可以被认为是轻量级版本的 dom。它同样是以原生对象">
<meta name="twitter:image" content="https://i7eo.com/2019/01/01/vdom/i7eo_854852a0e956219a4a2a016470fe6c6c.png">

  <!-- <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet"> -->
  <link href="//cdn.bootcss.com/node-waves/0.7.5/waves.min.css" rel="stylesheet">
  <link rel="stylesheet" href="/style.css">
  <script>
    function setLoadingBarProgress(num) {
      document.getElementById('loading-bar').style.width=num+"%";
    }
  </script>
</head>
</html>
<body>
  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <script>setLoadingBarProgress(20)</script> 
  <header class="l_header">
	<div class="wrapper">
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href="/">
				Solitude is freedom
			</a>
			<div class="menu">
				<ul class="h-list">
					
						<li>
							<a class="flat-box nav-home" href="/">
								Home
							</a>
						</li>
					
						<li>
							<a class="flat-box nav-archives" href="/archives">
								Archives
							</a>
						</li>
					
						<li>
							<a class="flat-box nav-about" href="/about">
								About
							</a>
						</li>
					
				</ul>
				<div class="underline"></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search">
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class="switcher h-list">
				
					<li class="s-search"><a href="javascript:void(0)"><span class="icon icon-search flat-box"></span></a></li>
				
				<li class="s-menu"><a href="javascript:void(0)"><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>

		<div class="nav-sub container container--flex">
			<a class="logo mlogo" href="javascript:void(0)">
				Word of Forks
			</a>

			<ul class="switcher h-list">
				<li class="s-comment"><a href="javascript:void(0)"><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class="s-top"><a href="javascript:void(0)"><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<!-- <li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li> -->
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/about" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

    <script>setLoadingBarProgress(40);</script>
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-vdom" class="post white-box article-type-post" itemscope="" itemprop="blogPost">
	<section class="meta">
	<h2 class="title">
  	<a href="/2019/01/01/vdom.html">
    	译文：Understanding the Virtual DOM
    </a>
  </h2>
	<time>
	  Jan 1, 2019
	</time>
	
    
    <span class="post-count">
      |&nbsp;字数 2498
    </span>
    <div class="cats">
        <a href="/categories/Javascript/">Javascript</a>
    </div>


	</section>
	
		<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#我们为什么需要虚拟-dom-？"><span class="toc-number">1.</span> <span class="toc-text">我们为什么需要虚拟 dom ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dom-并不是为此而生的"><span class="toc-number">2.</span> <span class="toc-text">Dom 并不是为此而生的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-因此而出现"><span class="toc-number">3.</span> <span class="toc-text">虚拟 Dom 因此而出现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-张什么样呢？"><span class="toc-number">4.</span> <span class="toc-text">虚拟 Dom 张什么样呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-如何使用？"><span class="toc-number">5.</span> <span class="toc-text">虚拟 Dom 如何使用？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#附录：snabbdom"><span class="toc-number">7.</span> <span class="toc-text">附录：snabbdom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动手模拟-patch-实现过程"><span class="toc-number">8.</span> <span class="toc-text">动手模拟 patch 实现过程</span></a></li></ol></section>
		<section class="toc-wrapper-vdom"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#我们为什么需要虚拟-dom-？"><span class="toc-number">1.</span> <span class="toc-text">我们为什么需要虚拟 dom ？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Dom-并不是为此而生的"><span class="toc-number">2.</span> <span class="toc-text">Dom 并不是为此而生的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-因此而出现"><span class="toc-number">3.</span> <span class="toc-text">虚拟 Dom 因此而出现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-张什么样呢？"><span class="toc-number">4.</span> <span class="toc-text">虚拟 Dom 张什么样呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#虚拟-Dom-如何使用？"><span class="toc-number">5.</span> <span class="toc-text">虚拟 Dom 如何使用？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#总结"><span class="toc-number">6.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#附录：snabbdom"><span class="toc-number">7.</span> <span class="toc-text">附录：snabbdom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#动手模拟-patch-实现过程"><span class="toc-number">8.</span> <span class="toc-text">动手模拟 patch 实现过程</span></a></li></ol></section>
	
	<section class="article typo">
  	<div class="article-entry" itemprop="articleBody">
    	<p>本文为译文，原文地址：</p>
<blockquote>
<p><a href="https://bitsofco.de/understanding-the-virtual-dom/" target="_blank" rel="noopener">Understanding the Virtual DOM</a></p>
</blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;我最近在写一些如何正确区分 dom 与 shadow dom 的文章。总的来说，dom 是HTML文档的基于对象的表示，以及操作该对象的接口。shadow dom 可以被认为是轻量级版本的 dom。它同样是以原生对象为基础的 html document，但是它并不是完整的。可能有些难懂，换一种说法来看，shadow dom 允许我们去将我们的 dom 划分的更小，更轻，可以跨文档使用。（这里作者想表达的意思是我们可以根据需要截取部分 dom 生成 vdom，而不用每次从 html 标签开始写 vdom 直到 html 标签闭合）</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;另一个你可能遇到过的相似说法称 “shadow dom” 为 “virtual DOM”。尽管</p>
<a id="more"></a>
<p>这个说法已经存在了很多年，但是它真正的流行是在 react 使用它之后。在这篇文章中我将尽力阐述什么是虚拟 dom ，它与原生 dom 又什么不同以及如何使用它。</p>
<h3 id="我们为什么需要虚拟-dom-？"><a href="#我们为什么需要虚拟-dom-？" class="headerlink" title="我们为什么需要虚拟 dom ？"></a>我们为什么需要虚拟 dom ？</h3><p>想要了解虚拟dom为什么会出现，让我们先回顾以下原生dom。正如我所提到的，dom 是HTML文档的基于对象的表示，以及操作该对象的接口。举个例子看看：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">head</span>&gt;</span><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"list__item"</span>&gt;</span>List item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以用如下 dom 树来表示：</p>
<p><img src="/2019/01/01/vdom/i7eo_854852a0e956219a4a2a016470fe6c6c.png" alt=""></p>
<p>让我们来进行以下操作：</p>
<ul>
<li>修改第一个 li 的内容为 list item one</li>
<li>加上一个 li</li>
</ul>
<p>要完成上述操作需要创建新节点，添加新属性与内容，最终完成更新：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> listItemOne = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"list__item"</span>)[<span class="number">0</span>];</span><br><span class="line">listItemOne.textContent = <span class="string">"List item one"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> list = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"list"</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">const</span> listItemTwo = <span class="built_in">document</span>.createElement(<span class="string">"li"</span>);</span><br><span class="line">listItemTwo.classList.add(<span class="string">"list__item"</span>);</span><br><span class="line">listItemTwo.textContent = <span class="string">"List item two"</span>;</span><br><span class="line">list.appendChild(listItemTwo);</span><br></pre></td></tr></table></figure>
<h3 id="Dom-并不是为此而生的"><a href="#Dom-并不是为此而生的" class="headerlink" title="Dom 并不是为此而生的"></a>Dom 并不是为此而生的</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;当1998年发布DOM的第一个规范时，我们以非常不同的方式构建和管理web页面。很少像今天这样依赖DOM api来创建和更新页面内容。</p>
<p>像 <code>document.getElementsByClassName()</code> 这个方法小规模使用没有问题，但是如果在同一页面间隔很短的情况下去更新多个元素，就会使对于 dom 的查询与更新操作变得很昂贵。此外，更新文档中较大一部分比更新特定元素的开销会小一些。回到我们列表例子中，从某种程度上来说用新元素替换整个无序列表比修改某个特定元素要简单一些。代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"list"</span>)[<span class="number">0</span>];</span><br><span class="line">list.innerHTML = <span class="string">`</span></span><br><span class="line"><span class="string">&lt;li class="list__item"&gt;List item one&lt;/li&gt;</span></span><br><span class="line"><span class="string">&lt;li class="list__item"&gt;List item two&lt;/li&gt;</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>
<p>在这俩个例子中，性能差异并不大。但是随着页面数量的增加，选择、更新我们需要的代码会显得尤为重要。</p>
<h3 id="虚拟-Dom-因此而出现"><a href="#虚拟-Dom-因此而出现" class="headerlink" title="虚拟 Dom 因此而出现"></a>虚拟 Dom 因此而出现</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;虚拟 Dom 的出现是为了用更加高效的方式来处理频繁更新 dom 所产生的问题。与 dom 和 shadow dom 不同的是，虚拟 dom 不是一种正式的规范，它更像一种与 dom 交互的新方法。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;虚拟 dom 可以被认为是原生 dom 的一个复制品。在这个复制品上我们可以不通过 dom api 就能频繁更新数据。一旦对虚拟DOM进行了所有更新，我们就可以查看需要对原始DOM进行哪些特定更改，并且使这些改变更加具体与优化。</p>
<h3 id="虚拟-Dom-张什么样呢？"><a href="#虚拟-Dom-张什么样呢？" class="headerlink" title="虚拟 Dom 张什么样呢？"></a>虚拟 Dom 张什么样呢？</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;一听到虚拟，可能会觉得有些神秘感。其实虚拟 dom 就是 js 对象。让我们再来回顾先前创建的 dom 树：</p>
<p><img src="/2019/01/01/vdom/i7eo_854852a0e956219a4a2a016470fe6c6c.png" alt=""></p>
<p>这个树可以表示为如下 js 对象：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vdom = &#123;</span><br><span class="line">    tagName: <span class="string">"html"</span>,</span><br><span class="line">    children: [</span><br><span class="line">        &#123; <span class="attr">tagName</span>: <span class="string">"head"</span> &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tagName: <span class="string">"body"</span>,</span><br><span class="line">            children: [</span><br><span class="line">                &#123;</span><br><span class="line">                    tagName: <span class="string">"ul"</span>,</span><br><span class="line">                    attributes: &#123; <span class="string">"class"</span>: <span class="string">"list"</span> &#125;,</span><br><span class="line">                    children: [</span><br><span class="line">                        &#123;</span><br><span class="line">                            tagName: <span class="string">"li"</span>,</span><br><span class="line">                            attributes: &#123; <span class="string">"class"</span>: <span class="string">"list__item"</span> &#125;,</span><br><span class="line">                            textContent: <span class="string">"List item"</span></span><br><span class="line">                        &#125; <span class="comment">// end li</span></span><br><span class="line">                    ]</span><br><span class="line">                &#125; <span class="comment">// end ul</span></span><br><span class="line">            ]</span><br><span class="line">        &#125; <span class="comment">// end body</span></span><br><span class="line">    ]</span><br><span class="line">&#125; <span class="comment">// end html</span></span><br></pre></td></tr></table></figure>
<p>我们完全可以把这个 js 对象当作虚拟 dom 。我们可以根据需要自由的频繁操作它而不改变原生 dom。</p>
<p>相比于使用整个对象，我们通常的做法是使用部分虚拟 dom。举个例子，我们要操作一个 list 组件，这个组件与我们的无序列表元素相关联。具体如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> list = &#123;</span><br><span class="line">    tagName: <span class="string">"ul"</span>,</span><br><span class="line">    attributes: &#123; <span class="string">"class"</span>: <span class="string">"list"</span> &#125;,</span><br><span class="line">    children: [</span><br><span class="line">        &#123;</span><br><span class="line">            tagName: <span class="string">"li"</span>,</span><br><span class="line">            attributes: &#123; <span class="string">"class"</span>: <span class="string">"list__item"</span> &#125;,</span><br><span class="line">            textContent: <span class="string">"List item"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="虚拟-Dom-如何使用？"><a href="#虚拟-Dom-如何使用？" class="headerlink" title="虚拟 Dom 如何使用？"></a>虚拟 Dom 如何使用？</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;现在我们见识过了虚拟dom的样子，那么它是如何处理dom操作的性能问题？</p>
<p>正如我所提到的，虚拟 dom 可以专门用来对你需要改变的元素进行操作。（不影响没有改变的元素）让我们重回无序列表的例子。</p>
<p>第一件事我们应该复制dom来产生虚拟dom，然后对需要改变的元素在虚拟dom中进行改变操作。如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> copy = &#123;</span><br><span class="line">    tagName: <span class="string">"ul"</span>,</span><br><span class="line">    attributes: &#123; <span class="string">"class"</span>: <span class="string">"list"</span> &#125;,</span><br><span class="line">    children: [</span><br><span class="line">        &#123;</span><br><span class="line">            tagName: <span class="string">"li"</span>,</span><br><span class="line">            attributes: &#123; <span class="string">"class"</span>: <span class="string">"list__item"</span> &#125;,</span><br><span class="line">            textContent: <span class="string">"List item one"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tagName: <span class="string">"li"</span>,</span><br><span class="line">            attributes: &#123; <span class="string">"class"</span>: <span class="string">"list__item"</span> &#125;,</span><br><span class="line">            textContent: <span class="string">"List item two"</span></span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>这个复制出来的虚拟 dom 用来和原生 dom 进行比较，从而把比较出来的差异用创建的 diff 来保存。 diff 是像这个样子的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> diffs = [</span><br><span class="line">    &#123;</span><br><span class="line">        newNode: &#123; <span class="comment">/* new version of list item one */</span> &#125;,</span><br><span class="line">        oldNode: &#123; <span class="comment">/* original version of list item one */</span> &#125;,</span><br><span class="line">        index: <span class="comment">/* index of element in parent's list of child nodes */</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        newNode: &#123; <span class="comment">/* list item two */</span> &#125;,</span><br><span class="line">        index: &#123; <span class="comment">/* */</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>这个 diff 提供了一个结构，这个结构可以用来更新原生的 dom。一旦所有的 diff 检测完毕，我们可以对原生 dom 只进行一次更新操作即可。</p>
<p>在下面的例子中，我们对 diff 进行循环，不论是添加新的元素还是更新旧的元素，我们都可以像下面这样做：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> domElement = <span class="built_in">document</span>.getElementsByClassName(<span class="string">"list"</span>)[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">diffs.forEach(<span class="function">(<span class="params">diff</span>) =&gt;</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> newElement = <span class="built_in">document</span>.createElement(diff.newNode.tagName);</span><br><span class="line">    <span class="comment">/* Add attributes ... */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (diff.oldNode) &#123;</span><br><span class="line">        <span class="comment">// If there is an old version, replace it with the new version</span></span><br><span class="line">        domElement.replaceChild(diff.newNode, diff.index);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// If no old version exists, create a new node</span></span><br><span class="line">        domElement.appendChild(diff.newNode);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>虚拟dom是让我们与dom交互更加高效的且性能更好一种方法</li>
<li>虚拟dom是一个js对象，它允许我们对js对象进行频繁的修改</li>
<li>所有的修改在虚拟dom中结束后，我们可以一次性对原生dom中需要改变的地方进行更新</li>
</ul>
<h3 id="附录：snabbdom"><a href="#附录：snabbdom" class="headerlink" title="附录：snabbdom"></a>附录：snabbdom</h3><p>实现 vdom 的库不多，snabbdom 算是佼佼者。vue 中集成了它的核心代码，在每次修改数据后，都会执行函数进行 diff。下面总结一下非框架下vdom的使用方法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"btn-submit"</span>&gt;</span>change<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-class.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-props.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-style.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-eventlisteners.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.bootcss.com/snabbdom/0.7.3/h.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上是html结构，引入不同的snabbdom文件是对应解析绑定的事件、属性等。首先使用 <code>patch(c, vnode)</code> 创建无序列表如下：</p>
<p><img src="/2019/01/01/vdom/i7eo_e5b8b50c2235d093133d181540a27ca4.png" alt=""></p>
<p>单击按钮再次调用 <code>patch</code> 函数即可生成：</p>
<p><img src="/2019/01/01/vdom/i7eo_f5991aaaa93507781a69bbf70d507739.png" alt=""></p>
<p>具体代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> snabbdom = <span class="built_in">window</span>.snabbdom</span><br><span class="line"></span><br><span class="line">      <span class="comment">// init snabbdom</span></span><br><span class="line">      <span class="keyword">let</span> patch = snabbdom.init([</span><br><span class="line">        snabbdom_class,</span><br><span class="line">        snabbdom_props,</span><br><span class="line">        snabbdom_style,</span><br><span class="line">        snabbdom_eventlisteners</span><br><span class="line">      ])</span><br><span class="line"></span><br><span class="line">      <span class="comment">//define h()</span></span><br><span class="line">      <span class="keyword">let</span> h = snabbdom.h</span><br><span class="line">      <span class="keyword">let</span> c = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>)</span><br><span class="line">      <span class="keyword">let</span> btn = <span class="built_in">document</span>.getElementById(<span class="string">'btn-submit'</span>)</span><br><span class="line"></span><br><span class="line">      <span class="comment">// create vnode</span></span><br><span class="line">      <span class="keyword">let</span> vnode = h(<span class="string">'ul#list'</span>, &#123;&#125;, [</span><br><span class="line">        h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'item1'</span>),</span><br><span class="line">        h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'item2'</span>)</span><br><span class="line">      ])</span><br><span class="line"></span><br><span class="line">      <span class="comment">// first time create vdom and transform it to dom</span></span><br><span class="line">      patch(c, vnode)</span><br><span class="line"></span><br><span class="line">      btn.addEventListener(<span class="string">'click'</span>, () =&gt; &#123;</span><br><span class="line">        <span class="comment">// define new node</span></span><br><span class="line">        <span class="keyword">let</span> newNode = h(<span class="string">'ul#list'</span>, &#123;&#125;, [</span><br><span class="line">          h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'item1'</span>),</span><br><span class="line">          h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'item22'</span>),</span><br><span class="line">          h(<span class="string">'li.item'</span>, &#123;&#125;, <span class="string">'item3'</span>)</span><br><span class="line">        ])</span><br><span class="line">        <span class="comment">// find diffs , update diffs into original DOM</span></span><br><span class="line">        patch(vnode, newNode)</span><br><span class="line">        vnode = newNode</span><br><span class="line">      &#125;)</span><br></pre></td></tr></table></figure>
<p>h 函数的作用是将传入的数据转化为vnode（vnode具体格式参照上述译文中的 copy），patch 函数先判断是否存在 vnode，不存在的话直接将 vnode，生成 dom，插入目标中；若存在进行 diff 算法，找出差异后对原生 dom 进行更新。</p>
<h3 id="动手模拟-patch-实现过程"><a href="#动手模拟-patch-实现过程" class="headerlink" title="动手模拟 patch 实现过程"></a>动手模拟 patch 实现过程</h3><p>patch 函数有俩种用法：</p>
<ul>
<li><code>patch(container, vnode)</code></li>
<li><code>patch(vnode, newNode)</code></li>
</ul>
<p>先来看第一种：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    tag: <span class="string">'ul'</span>,</span><br><span class="line">    attrs: &#123;</span><br><span class="line">        id: <span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children: [</span><br><span class="line">        &#123;</span><br><span class="line">            tag: <span class="string">'li'</span>,</span><br><span class="line">            attrs: &#123;</span><br><span class="line">                classname: <span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children: [<span class="string">'item1'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>item 1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>首先得将vnode转化为html结构，才能加入到container种，那么如何将上述js对象（vnode）转化为 html 呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createEl</span>(<span class="params">vnode</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> tag = vnode.tag</span><br><span class="line">    <span class="keyword">let</span> attrs = vnode.attrs || &#123;&#125;</span><br><span class="line">    <span class="keyword">let</span> children = vnode.children || []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!tag) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> el = <span class="built_in">document</span>.createElement(tag)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> attrName <span class="keyword">in</span> attrs) &#123;</span><br><span class="line">        <span class="keyword">if</span>(attrs.hasOwnProperty(attrName))&#123;</span><br><span class="line">            el.setAttribute(attrName, attrs[attrName])</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    children.forEach(<span class="function"><span class="params">v</span> =&gt;</span> &#123;</span><br><span class="line">        el.append(createElement(v))</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> el;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>大概就是这样，利用递归循环遍历 children，设置 <code>!tag</code> 为终止条件。</p>
<p>第二种：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    tag: <span class="string">'ul'</span>,</span><br><span class="line">    attrs: &#123;</span><br><span class="line">        id: <span class="string">'list'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    children: [</span><br><span class="line">        &#123;</span><br><span class="line">            tag: <span class="string">'li'</span>,</span><br><span class="line">            attrs: &#123;</span><br><span class="line">                classname: <span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children: [<span class="string">'item12'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            tag: <span class="string">'li'</span>,</span><br><span class="line">            attrs: &#123;</span><br><span class="line">                classname: <span class="string">'item'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            children: [<span class="string">'item2'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"list"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>item 12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item"</span>&gt;</span>item 2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里我们想要将列表更新为上述结构，使用 <code>patch(vnode, newNode)</code> 方法，这个方法中肯定是要不断的去对比，不断的对比children肯定还会用到递归，模拟代码（只考虑最简单的情况）如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">updateEl</span>(<span class="params">vnode, newNode</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> children = vnode.children || []</span><br><span class="line">    <span class="keyword">let</span> newChildren = newNode.children || []</span><br><span class="line"></span><br><span class="line">    children.forEach(<span class="function">(<span class="params">child, idx</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> newChild = newChildren[idx]</span><br><span class="line">        <span class="keyword">if</span>(newChild === <span class="literal">null</span>) <span class="keyword">return</span> ;</span><br><span class="line">        <span class="keyword">if</span>(child.tag === newChild.tag) &#123;</span><br><span class="line">            <span class="comment">// the same tag</span></span><br><span class="line">            updateEl(child, newChild)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">// the different tag</span></span><br><span class="line">            replaceNode(child, newChild)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

  	</div>
	  
	  <div class="article-tags tags">
      
        <a href="/tags/虚拟Dom/">虚拟Dom</a>
      
	  </div>
    

	
		<div class="art-item-footer">
				
					<span class="art-item-left">上一篇：<a href="/2019/01/03/vuesc.html" rel="prev" title="Vue 的响应式/模版解析/渲染">
						Vue 的响应式/模版解析/渲染
					</a></span>
				
				
					<span class="art-item-right">下一篇：<a href="/2018/11/11/Event-Loop总结.html" rel="next" title="Event Loop总结">
						Event Loop总结
					</a></span>
				
		</div>
	
	</section>
	
</article>
<script>
	window.subData = {
		title: '译文：Understanding the Virtual DOM',
		tools: true
	}
</script>

      </div>
      <aside class='l_side'>
        
    <section class="m_widget about">
<a href="/about">
  <img class="avatar waves-image" src="/images/avatar.jpg">
</a>
<div class="header">George Tan</div>
<div class="content">
<div class="desc">A man who dreams of being a full stack engineer</div>
</div>
</section>


    <!-- <section class='m_widget links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://ccoooss.com">
            <div class='name'>ClassicOldSong</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://frantic1048.logdown.com/">
            <div class='name'>Frantic1048</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://hclmaster.github.io/">
            <div class='name'>Hclmaster</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://whst.github.io/">
            <div class='name'>WANG Hsü-Tung</div>
        </a></li>
    
    </ul>
</div>
</section> -->


    <section class="m_widget categories">
<div class="header">Categories</div>
<div class="content">
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/HTML-CSS/"><div class="name">HTML&amp;CSS</div><div class="badget">4</div></a></li>
    
        <li><a class="flat-box" href="/categories/HTTP/"><div class="name">HTTP</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/Javascript/"><div class="name">Javascript</div><div class="badget">7</div></a></li>
    
        <li><a class="flat-box" href="/categories/Vuejs/"><div class="name">Vuejs</div><div class="badget">2</div></a></li>
    
        <li><a class="flat-box" href="/categories/自动化/"><div class="name">自动化</div><div class="badget">1</div></a></li>
    
        <li><a class="flat-box" href="/categories/运维/"><div class="name">运维</div><div class="badget">1</div></a></li>
    
    </ul>
    
</div>
</section>

    
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class="content">
        <a href="/tags/Alfred3-workflow/" style="font-size: 14px; color: #808080">Alfred3 workflow</a> <a href="/tags/EventLoop/" style="font-size: 14px; color: #808080">EventLoop</a> <a href="/tags/Nuxt-js/" style="font-size: 14px; color: #808080">Nuxt.js</a> <a href="/tags/SSR/" style="font-size: 14px; color: #808080">SSR</a> <a href="/tags/cloudflare/" style="font-size: 14px; color: #808080">cloudflare</a> <a href="/tags/flex/" style="font-size: 14px; color: #808080">flex</a> <a href="/tags/https/" style="font-size: 14px; color: #808080">https</a> <a href="/tags/prototype-proto/" style="font-size: 14px; color: #808080">prototype/_proto_</a> <a href="/tags/qshell/" style="font-size: 14px; color: #808080">qshell</a> <a href="/tags/rem/" style="font-size: 14px; color: #808080">rem</a> <a href="/tags/render-函数/" style="font-size: 14px; color: #808080">render 函数</a> <a href="/tags/sticky-footer/" style="font-size: 14px; color: #808080">sticky footer</a> <a href="/tags/webpack/" style="font-size: 14px; color: #808080">webpack</a> <a href="/tags/上下文/" style="font-size: 14px; color: #808080">上下文</a> <a href="/tags/作用域/" style="font-size: 14px; color: #808080">作用域</a> <a href="/tags/值传递/" style="font-size: 14px; color: #808080">值传递</a> <a href="/tags/图床/" style="font-size: 14px; color: #808080">图床</a> <a href="/tags/层叠上下文/" style="font-size: 14px; color: #808080">层叠上下文</a> <a href="/tags/执行环境/" style="font-size: 14px; color: #808080">执行环境</a> <a href="/tags/模版解析/" style="font-size: 14px; color: #808080">模版解析</a> <a href="/tags/水平垂直居中/" style="font-size: 14px; color: #808080">水平垂直居中</a> <a href="/tags/深拷贝/" style="font-size: 14px; color: #808080">深拷贝</a> <a href="/tags/继承/" style="font-size: 14px; color: #808080">继承</a> <a href="/tags/虚拟Dom/" style="font-size: 14px; color: #808080">虚拟Dom</a> <a href="/tags/闭包/" style="font-size: 14px; color: #808080">闭包</a> <a href="/tags/面向对象/" style="font-size: 14px; color: #808080">面向对象</a>
    </div>
</div>




      </aside>
      <script>setLoadingBarProgress(60);</script>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/i7eo" class="social github" target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/atom.xml" class="social rss" target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>

  <div>Theme <a href="https://github.com/stkevintan/hexo-theme-material-flow" class="codename">MaterialFlow</a> Powered by <a href="https://hexo.io/" target="_blank" class="codename">Hexo</a>.</div>

</footer>

  <script>setLoadingBarProgress(80);</script>
  

<!-- <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="//cdn.bootcss.com/jquery/2.1.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/node-waves/0.7.5/waves.min.js"></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>

  <script>setLoadingBarProgress(100);</script>
</body>
</html>
